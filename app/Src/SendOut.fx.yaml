"SendOut As screen.'tabletLayout_Email_ver3.0'":

    RectQuickActionBar1 As rectangle:
        Fill: =RGBA(255, 255, 255, 1)
        Height: =24
        Width: =Parent.Width
        ZIndex: =3

    LblRecipientCount1 As label:
        Height: =43
        PaddingLeft: =0
        Size: =13
        Text: ="*To (" &CountRows(MyPeople) & ")"
        Width: =103
        Wrap: =false
        X: =213
        Y: =47
        ZIndex: =5

    TextSearchBox1 As text:
        AccessibleLabel: ="Search people or add email address. At least one recipient is required for a successful submission."
        Default: =""
        Height: =43
        HintText: ="Search people or add email address"
        PaddingLeft: =50
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Width: =765
        X: =321
        Y: =47
        ZIndex: =6

    SearchIcon1 As icon.Search:
        Height: =Self.Width
        Icon: =Icon.Search
        PaddingBottom: =8
        PaddingLeft: =8
        PaddingRight: =8
        PaddingTop: =8
        Tooltip: ="Search"
        Width: =TextSearchBox1.Height
        X: =TextSearchBox1.X + 5
        Y: =TextSearchBox1.Y
        ZIndex: =7

    AddIcon1 As icon.Add:
        Height: =TextSearchBox1.Height
        Icon: =Icon.Add
        OnSelect: |-
            =Collect(MyPeople,           
            {DisplayName: TextSearchBox1.Text, UserPrincipalName: TextSearchBox1.Text, Mail: TextSearchBox1.Text});           
            Reset(TextSearchBox1)
        PaddingBottom: =5
        PaddingLeft: =5
        PaddingRight: =5
        PaddingTop: =5
        TabIndex: =0
        Tooltip: ="Select to add user to collection"
        Visible: |-
            =!IsBlank(TextSearchBox1.Text) &&           
            
            /*Is user entry a valid email address*/           
            IsMatch(TextSearchBox1.Text, Match.Email)           &&
            
            Not(Trim(TextSearchBox1.Text) in MyPeople.UserPrincipalName)
        Width: =70
        X: =TextSearchBox1.X + TextSearchBox1.Width - Self.Width - 10
        Y: =TextSearchBox1.Y
        ZIndex: =8

    EmailPeopleGallery1 As gallery.SelectedUsersTabletGallery:
        AccessibleLabel: ="User selected people"
        BorderColor: =TextSearchBox1.BorderColor
        Height: |-
            =/*Height adjusts to number of items in gallery*/
            Min((Self.TemplateHeight + Self.TemplatePadding * 2) * RoundUp(CountRows(Self.AllItems) / 4, 0), 182)
        Items: |-
            =/*Collection of user selected people*/
            MyPeople
        Layout: =Layout.Vertical
        ShowScrollbar: =Self.Height >= 182
        TemplateSize: =-5
        Width: =1045
        WrapCount: =4
        X: =93
        Y: =TextSearchBox1.Y + TextSearchBox1.Height
        ZIndex: =9

        Rectangle3 As rectangle:
            Height: =42
            OnSelect: =Select(Parent)
            Width: =229
            X: =39
            ZIndex: =1

        Title1 As label:
            FocusedBorderThickness: =2
            Height: =42
            OnSelect: =Set(_selectedUser, ThisItem)
            PaddingLeft: =10
            Size: =13
            TabIndex: =If(PeopleBrowseGallery1.Visible, -1, 0)
            Text: =ThisItem.DisplayName
            VerticalAlign: =Middle
            Width: =236
            Wrap: =false
            X: =32
            ZIndex: =2

        iconRemove1 As icon.Cancel:
            AccessibleLabel: =iconRemove1.Tooltip
            Color: =Title1.Color
            Height: =EmailPeopleGallery1.TemplateHeight
            Icon: =Icon.Cancel
            OnSelect: =Remove(MyPeople, LookUp(MyPeople, UserPrincipalName = ThisItem.UserPrincipalName))
            PaddingBottom: =9
            PaddingLeft: =9
            PaddingRight: =9
            PaddingTop: =9
            TabIndex: =If(PeopleBrowseGallery1.Visible, -1, 0)
            Tooltip: ="Select to remove user from collection"
            Width: =Self.Height
            X: =EmailPeopleGallery1.TemplateWidth - Self.Width
            ZIndex: =3

    LblEmailSubject1 As label:
        Height: =43
        PaddingLeft: =0
        Size: =13
        Text: ="*Subject"
        Width: =118
        Wrap: =false
        X: =262
        Y: =127
        ZIndex: =10

    TextEmailSubject1 As text:
        AccessibleLabel: ="A subject is required to send an email."
        Default: =DataCardValue27
        Height: =43
        HintText: ="Add a subject"
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        TabIndex: =If(PeopleBrowseGallery1.Visible, -1, 0)
        Width: =701
        X: =379
        Y: =127
        ZIndex: =11

    LblEmailMessage1 As label:
        Height: =47
        PaddingLeft: =0
        Size: =13
        Text: ="Message"
        Width: =119
        Wrap: =false
        X: =262
        Y: =236
        ZIndex: =12

    PeopleBrowseGallery1 As gallery.PeoplePickerGallerySmallTablet:
        AccessibleLabel: ="User look up search results"
        BorderThickness: =2
        Fill: =Parent.Fill
        Height: =If(Self.Visible, Parent.Height / 2 + 200, 0)
        Items: |-
            =/*Only use Office 365 Users operation if user has started searching*/
            If(!IsBlank(Trim(TextSearchBox1.Text)), Office365Users.SearchUser({searchTerm: Trim(TextSearchBox1.Text), top: 15}))
        Layout: =Layout.Vertical
        TemplatePadding: =0
        TemplateSize: =104
        Visible: =!IsBlank(Trim(TextSearchBox1.Text))
        Width: =Parent.Width - Self.X * 2
        X: =32
        Y: =TextSearchBox1.Y + TextSearchBox1.Height
        ZIndex: =13

        Rectangle4 As rectangle:
            BorderColor: =Title2.Color
            BorderThickness: =If(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName, 4, 0)
            Fill: =RGBA(0,0,0,0)
            Height: =Parent.TemplateHeight
            HoverFill: =RGBA(0,0,0,0)
            OnSelect: =Select(Title2)
            Width: =Parent.TemplateWidth
            ZIndex: =1

        Title2 As label:
            BorderColor: =Self.Color
            FocusedBorderThickness: =2
            OnSelect: |-
                =/*Select user, clear search contents and if this user hasn't been added to MyPeople collection, add them*/
                Concurrent(
                Set(_selectedUser, ThisItem),
                Reset(TextSearchBox1),
                If(Not(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName), Collect(MyPeople, ThisItem)))
            Size: =17
            TabIndex: =0
            Text: =ThisItem.DisplayName
            VerticalAlign: =Middle
            Width: =PeopleBrowseGallery1.TemplateWidth - 2 * Self.X
            Wrap: =false
            X: =16
            Y: =4
            ZIndex: =2

        Subtitle1 As label:
            Color: =ColorFade(Title2.Color, 0.20)
            FocusedBorderThickness: =2
            OnSelect: =Select(Title2)
            Size: =17
            Text: =ThisItem.UserPrincipalName
            VerticalAlign: =Middle
            Width: =PeopleBrowseGallery1.TemplateWidth - 2 * Self.X
            Wrap: =false
            X: =Title2.X
            Y: =Title2.Y + Title2.Height + 3
            ZIndex: =3

        Separator1 As rectangle:
            Height: =1
            OnSelect: =Select(Parent)
            Width: =Parent.TemplateWidth
            Y: =Parent.TemplateHeight - 1
            ZIndex: =4

    Button2 As button:
        Height: =52
        OnSelect: |-
            =Set(_emailRecipientString, Concat(MyPeople, Mail & ";"));           
            Office365Outlook.SendEmailV2(_emailRecipientString, TextEmailSubject1.Text, TextInput2.Text, {Importance:"Normal"});           
            Reset(TextEmailSubject1);           
            Reset(TextInput2);           
            Clear(MyPeople)
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Text: ="Launch Campaign"
        Width: =188
        X: =588
        Y: =670
        ZIndex: =14

    Gallery4 As gallery.galleryVertical:
        Height: =30
        Items: =CampaignList
        Layout: =Layout.Vertical
        TemplateSize: =25
        Width: =1284
        X: =18
        Y: =625
        ZIndex: =15

    HtmlText1_1 As htmlViewer:
        Height: =275
        HtmlText: |-
            ="<div style = 'width:50%; margin-left:102px; font-size:33px; color:rgba(161, 0, 255, 1)'>Design and Build</div>
            <div style = 'width:50%; margin-left:102px'>We are part of Baltic ATC. Our team are creative dreamers who love to inspire clients all over the world and bring valuable, tailored solutions for the most challenging pains that the future users might have. We create a vision and then build it into reality.  That’s the beauty of it – as one team we make sure no great ideas are lost along the way.</div>"
        Width: =997
        X: =213
        Y: =339
        ZIndex: =16

    TextInput2 As text:
        Default: =RichTextEditor6.HtmlText
        Height: =85
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Width: =701
        X: =380
        Y: =213
        ZIndex: =17

